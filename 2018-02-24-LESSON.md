# Add Router, Add Views, Add Controllers

## Routing

Without doing anything extra normal routing will work like this when visiting a web site.
```
http://localhost:8080/index.php
http://localhost:8080/about.php
http://localhost:8080/contact.php
```
Each of these are individual files. For smaller sites this works ok, but it can get out of hand quickly if you have anything larger.

So when you need more flexibility you can setup a router. This will enable urls like so:
```
http://localhost:8080/
http://localhost:8080/about
http://localhost:8080/contact
```
They all route back through the `index.php` file. Behind the scenes it works like this but the urls look like the above urls (clean and nice!):
```
http://localhost:8080/index.php
http://localhost:8080/index.php?page=about
http://localhost:8080/index.php?page=contact
```

### Changes needed for Routing

Lets start separating our files correctly. First lets create a `views` directory. We can move our about.php, contact.php in and rename them, also create a index.view.php.

If we look at our index.php file it's handling the entry point of our app but it's also handling the view. So lets separate that out. Lets create a `controllers` directory.

Add the views to each:
```php
# inside about.php
require 'about.view.php';
```

-----------------


Install mod_rewrite for apache2, inside vagrant:
```bash
sudo a2enmod rewrite
sudo systemctl restart apache2
```

We also need to update the config to enable `.htaccess`
```
<VirtualHost *:80>
    <Directory /var/www/html>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride All
        Require all granted
    </Directory>

    . . .
</VirtualHost>
```

Create `.htaccess` inside `/var/www/html`:
```
Options +FollowSymLinks
RewriteEngine On

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^ index.php [L]
```
